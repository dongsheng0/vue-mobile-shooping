{"remainingRequest":"C:\\project_xcx\\vue-mobile-shooping\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\project_xcx\\vue-mobile-shooping\\src\\pages\\product\\scenic\\order.vue?vue&type=style&index=0&id=61e256b6&lang=less&scoped=true&","dependencies":[{"path":"C:\\project_xcx\\vue-mobile-shooping\\src\\pages\\product\\scenic\\order.vue","mtime":1567675004997},{"path":"C:\\project_xcx\\vue-mobile-shooping\\node_modules\\css-loader\\index.js","mtime":499162500000},{"path":"C:\\project_xcx\\vue-mobile-shooping\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\project_xcx\\vue-mobile-shooping\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\project_xcx\\vue-mobile-shooping\\node_modules\\less-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\project_xcx\\vue-mobile-shooping\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\project_xcx\\vue-mobile-shooping\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n@import \"../../../assets/style/global\";\r\n.order {\r\n  .date {\r\n    color: #424242;\r\n    margin: 0.5rem 0;\r\n\r\n    &-btn {\r\n      margin-left: 10px;\r\n      padding: 10px 0;\r\n      display: block;\r\n      line-height: 18px;\r\n      text-align: center;\r\n      box-shadow: 0px 6px 12px 0px rgba(0, 0, 0, 0.08);\r\n      border-radius: 13px;\r\n      background: #fff;\r\n      &.active {\r\n        color: #fff;\r\n        background: linear-gradient(\r\n          -90deg,\r\n          rgba(254, 167, 99, 0.5) 0%,\r\n          rgba(242, 111, 84, 1) 100%\r\n        );\r\n      }\r\n    }\r\n    &-btn-last {\r\n      border-radius: 13px 0 0 13px;\r\n      height: 100%;\r\n      box-sizing: border-box;\r\n      line-height: 36px;\r\n    }\r\n  }\r\n  .tips {\r\n    text-align: left;\r\n    padding-bottom: 5px;\r\n    font-size: 12px;\r\n    padding-left: 15px;\r\n    p {\r\n      color: rgba(254, 163, 98, 1);\r\n    }\r\n  }\r\n}\r\n",{"version":3,"sources":["order.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6MA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"order.vue","sourceRoot":"src/pages/product/scenic","sourcesContent":["\r\n\r\n<template>\r\n  <!-- 提交订单-景区 -->\r\n  <div class=\"order\">\r\n    <ticket :ticket=\"details\" />\r\n    <div class=\"left-bar\">使用日期</div>\r\n    <div class=\"date\">\r\n      <van-row type=\"flex\" justify=\"space-between\">\r\n        <van-col span=\"6\" v-for=\"(item, i) in details.priceAndStock\" :key=\"i\">\r\n          <div class=\"date-btn\" :class=\"{'active': activeDate==i? true: false}\" @click=\"handelDatetime(item,i)\">\r\n            <p>{{item.dateFromNow}}{{item.date}}</p>\r\n            <p>{{item.price}}元</p>\r\n          </div>\r\n        </van-col>\r\n        <van-col span=\"6\" @click=\"handelDatetimePicker\">\r\n          <div class=\"date-btn date-btn-last\">\r\n            <p>更多日期</p>\r\n            <p>{{datetimePicker}}</p>\r\n            <p></p>\r\n          </div>\r\n        </van-col>\r\n      </van-row>\r\n    </div>\r\n    <div class=\"left-bar\">购买数量</div>\r\n    <div class=\"order-num\">\r\n      <van-stepper\r\n        v-model=\"creatOrderForm.buyNum\"\r\n        :max=\"details.maxPerOrder\"\r\n        integer\r\n        input-width=\"60px\"\r\n        @change=\"changeOrderNum\"\r\n      />\r\n      <div class=\"tips\">\r\n        <p v-for=\"(item, i) in details.useRules\" :key=\"i\">{{item}}</p>\r\n      </div>\r\n    </div>\r\n    <div class=\"left-bar\">预订人信息</div>\r\n    <div class=\"order-userinfo\">\r\n      <div class=\"field-label\">联系人</div>\r\n      <van-field v-model=\"creatOrderForm.fillInfo.name\" placeholder=\"请输入用户名\" />\r\n      <div class=\"field-label\">手机号</div>\r\n      <van-field v-model=\"creatOrderForm.fillInfo.mobile\" placeholder=\"请输入接收信息的手机号\" />\r\n      <div class=\"field-label\">证件类型</div>\r\n      <select-picker\r\n        placeholder=\"请选择证件类型\"\r\n        :selectValue=\"creatOrderForm.fillInfo.cardType\"\r\n        @select=\"selectCardType\"\r\n        :columns=\"cardTypeOptions\"\r\n      />\r\n      <div class=\"field-label\">证件号</div>\r\n      <van-field v-model=\"creatOrderForm.fillInfo.cardNo\" placeholder=\"请输入证件号\" />\r\n      <div class=\"field-label\">备注信息</div>\r\n      <van-field type=\"textarea\" rows=\"1\" autosize placeholder=\"请输入备注信息\" />\r\n    </div>\r\n    <!-- 提交订单 -->\r\n    <div class=\"save-order\">\r\n      <van-row type=\"flex\" justify=\"space-between\" align=\"center\">\r\n        <van-col span=\"6\" class>￥{{allPrice}}</van-col>\r\n        <van-col span=\"18\" class=\"save-order-btn\">\r\n          <span @click=\"saveOrder\">提交订单</span>\r\n        </van-col>\r\n      </van-row>\r\n    </div>\r\n    <!-- 提交订单 -->\r\n    <van-popup v-model=\"showDatetimePicker\" position=\"bottom\">\r\n      <van-datetime-picker\r\n        v-model=\"currentDate\"\r\n        type=\"date\"\r\n        :min-date=\"minDate\"\r\n        @cancel=\"showDatetimePicker = !showDatetimePicker\"\r\n        @confirm=\"onConfirmDatetimePicker\"\r\n      />\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport serverHttp from '../../../assets/js/api'\r\nimport selectPicker from '../../../components/common/selectpicker'\r\nimport ticket from \"../../../components/detail/ticket\";\r\nimport WXPay from '../../../assets/js/wxpay'\r\n// import moment from 'moment'\r\nexport default {\r\n  data () {\r\n    return {\r\n      activeDate: '',\r\n      price: '', // 单价\r\n      showDatetimePicker: false,\r\n      datetimePicker: '',\r\n      minDate: new Date(),\r\n      currentDate: new Date(),\r\n      detailId: this.$route.params.id,\r\n      details: {},\r\n      creatOrderForm: {\r\n        ticketId: +this.$route.params.id,\t// 是\tint\t门票ID\r\n        preorderDate: '20190905', \t// 是\tint\t预定日期 yyyyMMdd格式\r\n        buyNum: 1, //\t是\tint\t购买数量\r\n        fillInfo: {\r\n          \"name\": \"wds\", //姓名\r\n          \"mobile\": '1370123913', //手机号\r\n          \"cardType\": 0,\r\n          \"cardNo\": \"130724198902123814\" //证件号\r\n        }\r\n      },\r\n      cardTypeOptions: [\r\n        { text: '身份证', type: 0 },\r\n        { text: '台胞证', type: 1 },\r\n        { text: '港澳通行证', type: 2 },\r\n        { text: '护照', type: 3 },\r\n      ]\r\n    }\r\n  },\r\n  computed: {\r\n    allPrice () {\r\n      return this.creatOrderForm.buyNum * this.price\r\n    }\r\n  },\r\n  components: {\r\n    selectPicker,\r\n    ticket\r\n  },\r\n  mounted () {\r\n    this.preorder()\r\n  },\r\n  methods: {\r\n    selectCardType (e) {\r\n      if (typeof e == 'object') {\r\n        this.creatOrderForm.fillInfo.cardType = e.type\r\n      }\r\n    },\r\n    // 提交订单\r\n    saveOrder () {\r\n      console.log(this.creatOrderForm);\r\n      // creatOrderForm\r\n      // infoRules\": { //必填信息规则\r\n      //       \"needAllGuestInfo\": false, //是否需要所有游客的信息\r\n      //       \"checkName\": true, //填写姓名\r\n      //       \"checkMobile\": true, //填写手机号\r\n      //       \"checkSfz\": true, //填写身份证号\r\n      //       \"checkTbz\": false, //填写台胞证\r\n      //       \"checkGatxz\": false, //填写港澳通行证\r\n      //       \"checkHz\": false//填写护照\r\n      //   }\r\n\r\n      if (!this.creatOrderForm.preorderDate) {\r\n        this.$toast('选择日期')\r\n      } else if (!this.creatOrderForm.fillInfo.name) {\r\n        this.$toast('姓名')\r\n      } else if (this.creatOrderForm.fillInfo.mobile) {\r\n        this.$toast('手机号')\r\n      } else if (this.creatOrderForm.preorderDate) {\r\n        //\r\n      } else {\r\n        this.creatOrder()\r\n      }\r\n      this.creatOrder()\r\n    },\r\n    creatOrder () {\r\n      let data = Object.assign({}, this.creatOrderForm)\r\n      data.fillInfo = JSON.stringify(data.fillInfo)\r\n      console.log(data)\r\n      serverHttp.scenicSpotsCreateOrderApi(data).then(res => {\r\n        WXPay(res.rs.orderNo)\r\n      })\r\n    },\r\n    // 更多日期\r\n    handelDatetimePicker () {\r\n      this.showDatetimePicker = true\r\n    },\r\n    // 今天，明天，后天\r\n    handelDatetime (item, i) {\r\n      this.activeDate = i\r\n      this.creatOrderForm.preorderDate = item.stock_date\r\n      this.datetimePicker = ''\r\n      this.price = this.details.priceAndStock[0].price // 缺少选择某一天的价钱，就直接显示今天的价钱\r\n    },\r\n    // 选择日期-确定\r\n    onConfirmDatetimePicker (value) {\r\n      this.showDatetimePicker = !this.showDatetimePicker\r\n      console.log(value)\r\n      this.datetimePicker = this.creatOrderForm.preorderDate = (new Date(value).getMonth()) + 1\r\n      this.activeDate = -1\r\n      this.price = item.price\r\n    },\r\n    // 数量改变\r\n    changeOrderNum () {\r\n\r\n    },\r\n    // 获取订单详情\r\n    preorder () {\r\n      serverHttp.scenicSpotsPreorderApi({ id: parseInt(this.detailId) }).then(res => {\r\n        this.details = res.rs\r\n        this.details.source = 'scenic'\r\n        let dateName = ['今天', '明天', '后天']\r\n        this.details.priceAndStock.forEach((item, i) => {\r\n          item.dateFromNow = dateName[i]\r\n          // item.date = `${moment(item.stock_date, \"YYYYMMDD\").get('month') + 1}/${moment(item.stock_date, \"YYYYMMDD\").get('day')}`\r\n        });\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n@import \"../../../assets/style/global\";\r\n.order {\r\n  .date {\r\n    color: #424242;\r\n    margin: 0.5rem 0;\r\n\r\n    &-btn {\r\n      margin-left: 10px;\r\n      padding: 10px 0;\r\n      display: block;\r\n      line-height: 18px;\r\n      text-align: center;\r\n      box-shadow: 0px 6px 12px 0px rgba(0, 0, 0, 0.08);\r\n      border-radius: 13px;\r\n      background: #fff;\r\n      &.active {\r\n        color: #fff;\r\n        background: linear-gradient(\r\n          -90deg,\r\n          rgba(254, 167, 99, 0.5) 0%,\r\n          rgba(242, 111, 84, 1) 100%\r\n        );\r\n      }\r\n    }\r\n    &-btn-last {\r\n      border-radius: 13px 0 0 13px;\r\n      height: 100%;\r\n      box-sizing: border-box;\r\n      line-height: 36px;\r\n    }\r\n  }\r\n  .tips {\r\n    text-align: left;\r\n    padding-bottom: 5px;\r\n    font-size: 12px;\r\n    padding-left: 15px;\r\n    p {\r\n      color: rgba(254, 163, 98, 1);\r\n    }\r\n  }\r\n}\r\n</style>"]}]}